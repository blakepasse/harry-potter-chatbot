This is a rag algorithm